let Database = require('./database');

class Exploits {
  constructor() {
    this.table = 'exploits';
    this.id = 'id';
    this.file = 'file';
    this.description = 'description';
    this.date = '_date';
    this.author = 'author';
    this.platform = 'platform';
    this.type = 'type';
    this.port = 'port';
  }

  async searchExploit(term, filter) {
    let database = new Database();

    let searchTerm = '%' + term + '%';
    let query = `SELECT * FROM ${this.table} WHERE ? LIKE ?`;
    let options = [filter, searchTerm];
    await database.query(query,options)
      .then(response => {
        console.log(response);
        database.close();
      })
      .catch(err => {
        console.log(err);
        database.close();
      })
  }
}

module.exports = Exploits;
