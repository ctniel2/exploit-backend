let Database = require('./database');

class Users {
  constructor() {
    this.table = 'users';
    this.id = 'id';
    this.firstName = 'firstName';
    this.lastName = 'lastName';
    this.apiKey = 'apiKey';
    this.password = 'password';
    this.isAdmin = 'isAdmin';
    this.email = 'email';
  }

  async getUser(uid) {
    let database = new Database();

    let query = `SELECT * FROM ${this.table} WHERE ${this.id} = ?`;
    let options = [uid];

    return await database.query(query, options)
      .then(response => {
        return response[0];
      })
      .catch(err => {
        throw(err);
      })
      .finally(database.close());
  }

  async login(email, password) {
    let database = new Database();
    console.log(email);
    console.log(password);
    
    let query = `SELECT * FROM ${this.table} WHERE ${this.email} = ? AND ${this.password} = ?`;
    let options = [email, password];

    return await database.query(query, options)
      .then(response => {
        console.log(response);
        return response[0];
      })
      .catch(err => {
        throw(err);
      })
      .finally(database.close());
  }

}

module.exports = Users;
